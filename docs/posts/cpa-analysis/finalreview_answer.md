# 截面与面板数据分析 - 期末复习习题

## 说明
本文档整理了截面与面板数据分析课程的期末复习习题。

---

## 习题列表

### 题目 1

如果对回归方程 $y_i = \beta_0 + \beta_1 x_i + \varepsilon_i$，有 $Cov(\varepsilon_i, x_i) = 0$，则下列结论一定成立的是：

A. $\varepsilon_i$ 与 $x_i$ 相互独立

B. $\beta_0$ 和 $\beta_1$ 的最小二乘（OLS）估计量是一致估计量

C. $\beta_0$ 和 $\beta_1$ 的最小二乘（OLS）估计量是无偏估计量

D. 以上都不是

---

### 题目 2

设 $\{X_n\}$ 为一列独立同分布的随机变量序列,其概率质量函数为：

$$P(X_n) = \begin{cases}
\frac{1}{2} - \frac{1}{n+2}, & X_n = 1 \\
\frac{1}{2} + \frac{1}{n+2}, & X_n = -1
\end{cases}$$

当 $n \to \infty$ 时,$X_n$ 的渐进性质为：

A. 依概率收敛

B. 依分布收敛

C. 几乎处处收敛

D. 以上都不是

---

### 题目 3

考虑一个由 $G$ 个联立方程组成的系统：

$$y_{gi} = \mathbf{x}_{gi}'\boldsymbol{\beta}_g + \varepsilon_{gi}, \quad g = 1, ..., G; \quad i = 1, ..., N$$

其中 $\mathbf{x}_{gi}$ 可能包含内生变量,因此我们引入了有效的工具变量 $\mathbf{z}_{gi}$。请简要阐述三阶段最小二乘估计量(3SLS)作为一种广义矩估计的基本假设条件。

---

### 题目 4

考虑使用极大似然法估计一个仅包含截距项的 Logit 模型。在一个样本量为 1000 的数据集中,二元选择变量 $y = 1$ 的观测值个数为 300,$y = 0$ 的观测值个数为 700。请给出此样本的对数似然函数值。

---

### 题目 5

随机变量 $X$ 的概率质量函数如下:

$$P(X = x) = \begin{cases}
\theta^2, & x = 4 \\
\theta(1-\theta), & x = 7 \\
\theta(1-\theta), & x = 9 \\
(1-\theta)^2, & x = 12
\end{cases}$$

如果我们有独立同分布样本 $X_1 = 4, X_2 = 9, X_3 = 9, X_4 = 12, X_5 = 7$,请给出 $\theta$ 的极大似然估计量和基于期望的矩估计量。

---

### 题目 6

对一个线性一元回归模型:

$$y_i = \beta_0 + \beta_1 x_i + \varepsilon_i$$

参数 $\beta_0$ 和 $\beta_1$ 的最小二乘估计量分别为 1.583 和 -0.768,其协方差矩阵的估计量为:

$$\widehat{Var}(\boldsymbol{\beta}) = \begin{bmatrix} 0.632 & 0.024 \\ 0.024 & 0.245 \end{bmatrix}$$

我们希望检验如下原假设:

$$H_0: \beta_0 + \beta_1 = 1$$

请详细给出 Wald 检验的步骤、统计量的值以及其分布。

---

### 题目 7

在精算行业中,常用贝尼尼分布(Benini distribution)来描述理赔申请的金额。一个单参数贝尼尼分布的概率密度函数为:

$$f(x; \theta) = \frac{2\theta}{x} \ln x \exp\{-\theta(\ln x)^2\}, \quad x > 1, \theta > 0$$

我们得到如下申请金额(百万元)的样本:

1.885, 2.085, 1.572, 2.354, 1.571, 2.467, 1.334, 2.106, 2.154, 1.351

**问题:**

(1) 根据上述观测值,请给出参数 $\theta$ 的极大似然估计量(7分);

(2) 请给出第1问中估计量的渐近方差表达式及其样本估计(7分);

(3) 请用极大似然估计量估计申请金额低于3百万元的概率(8分);

(4) 请给出第3问中估计量的渐近方差表达式及其样本估计(8分)。

---


---

## 知识点考察与讨论

### 一、回归分析基础理论

**核心知识点:**
- OLS估计量的性质:无偏性、一致性、有效性
- 零条件均值假设 vs 零协方差假设
- 独立性 vs 不相关性的区别

**题目1考察要点:**

题目1着重考察学生对OLS估计量性质的理解。关键辨析点在于:

1. **零协方差条件的含义**: $Cov(\varepsilon_i, x_i) = 0$ 是一个比独立性更弱的条件
   - 独立性 → 零协方差 (充分条件)
   - 零协方差 ↛ 独立性 (非必要条件)

2. **无偏性的充分条件**: 
   - 严格外生性: $E(\varepsilon_i | x_i) = 0$ → 无偏性
   - 零协方差仅保证: $E(\varepsilon_i \cdot x_i) = 0$
   - 在非线性情况下,零协方差不足以保证无偏性

3. **一致性的充分条件**:
   - 需要更强的条件,如大数定律的适用性
   - 零协方差结合其他正则性条件可能不足

**讨论问题:**
- 在什么情况下,零协方差假设足以保证OLS估计量的无偏性?
- 举例说明存在零协方差但非独立的情况

---

### 二、渐近理论与收敛性

**核心知识点:**
- 依概率收敛 (convergence in probability)
- 依分布收敛 (convergence in distribution)  
- 几乎处处收敛 (almost sure convergence)
- 收敛性之间的关系

**题目2考察要点:**

题目2通过一个具体的概率质量函数序列,考察学生对不同收敛概念的理解:

1. **分析概率极限**:
   - 当 $n \to \infty$ 时,$P(X_n = 1) \to 1/2$, $P(X_n = -1) \to 1/2$
   - 极限分布存在且为确定的分布

2. **判断收敛类型**:
   - 依分布收敛:序列收敛到一个固定的分布
   - 依概率收敛:序列收敛到一个常数
   - 几乎处处收敛:最强的收敛形式

3. **关系链**:
   $$\text{a.s. convergence} \Rightarrow \text{convergence in prob.} \Rightarrow \text{convergence in dist.}$$

**讨论问题:**
- 为什么 $X_n$ 不依概率收敛到某个常数?
- 如何构造一个依概率收敛但不几乎处处收敛的例子?

---

### 三、联立方程模型与工具变量

**核心知识点:**
- 内生性问题的来源
- 工具变量的有效性条件
- 2SLS、3SLS估计方法
- GMM框架下的理解

**题目3考察要点:**

题目3要求学生阐述3SLS作为GMM估计的假设条件:

1. **工具变量的有效性**:
   - 相关性条件: $E(\mathbf{z}_{gi}' \mathbf{x}_{gi})$ 满秩
   - 外生性条件: $E(\mathbf{z}_{gi}' \varepsilon_{gi}) = 0$

2. **矩条件的设定**:
   - 对每个方程 $g$,矩条件为: $E(\mathbf{z}_{gi} \varepsilon_{gi}) = 0$
   - 系统矩条件: 所有方程的矩条件联合

3. **3SLS的优势**:
   - 考虑方程间误差项的同期相关性
   - 相比2SLS,在满足同方差假设下更有效
   - 系统估计 vs 单方程估计

**讨论问题:**
- 3SLS相比2SLS的效率增益来源于何处?
- 如果误差项不存在跨方程相关性,3SLS退化为什么?

---

### 四、极大似然估计

**核心知识点:**
- 似然函数的构造
- 对数似然函数的性质
- MLE的求解方法
- MLE的渐近性质

**题目4、5、7考察要点:**

这三道题从不同角度考察MLE:

**题目4 - Logit模型的似然函数**:
1. 二元选择模型的基本形式
2. 似然函数的对数变换
3. 仅含截距项的简化情况

**题目5 - 离散分布的MLE**:
1. 离散分布的似然函数构造
2. 对数似然函数的求导
3. MLE vs 矩估计的比较

**题目7 - 连续分布的综合应用**:
1. 连续分布的似然函数
2. MLE的计算
3. MLE的渐近正态性
4. Delta方法的应用

**讨论问题:**
- 在什么情况下,MLE与矩估计会给出相同结果?
- 如何验证MLE的一阶条件确实给出极大值而非极小值?

---

### 五、假设检验理论

**核心知识点:**
- Wald检验
- LM检验  
- LR检验
- 三大检验的关系与应用场景

**题目6考察要点:**

题目6通过一个线性约束检验,考察Wald检验的应用:

1. **Wald统计量的构造**:
   - 约束形式: $R\boldsymbol{\beta} = r$,其中 $R = [1, 1]$, $r = 1$
   - 统计量: $W = (R\hat{\boldsymbol{\beta}} - r)'[R\widehat{Var}(\hat{\boldsymbol{\beta}})R']^{-1}(R\hat{\boldsymbol{\beta}} - r)$

2. **渐近分布**:
   - 在原假设下: $W \sim \chi^2(q)$,其中 $q$ 为约束个数
   - 本题中 $q = 1$

3. **计算步骤**:
   - 计算约束的违反程度: $R\hat{\boldsymbol{\beta}} - r$
   - 计算约束违反的方差: $R\widehat{Var}(\hat{\boldsymbol{\beta}})R'$
   - 构造二次型统计量

**讨论问题:**
- Wald检验、LM检验、LR检验在什么情况下会给出相同结论?
- 如果要检验 $H_0: \beta_1 = 0$ 和 $H_0: \beta_0 + \beta_1 = 1$ 的联合假设,如何修改Wald统计量?

---

### 六、渐近理论的应用

**核心知识点:**
- 渐近正态性
- Delta方法
- 方差估计
- 置信区间构造

**题目7的第(2)(4)问深入考察**:

1. **MLE的渐近方差**:
   - Fisher信息矩阵的计算
   - 渐近方差: $Avar(\hat{\theta}) = [I(\theta)]^{-1}$
   - 样本估计: 用 $\hat{\theta}$ 替换 $\theta$

2. **Delta方法的应用**:
   - 对于 $g(\theta)$ 的MLE: $\hat{g} = g(\hat{\theta})$
   - 渐近方差: $Avar(\hat{g}) = [g'(\theta)]^2 \cdot Avar(\hat{\theta})$
   - 题目中 $g(\theta)$ 为CDF

3. **实际计算考虑**:
   - 数值求导 vs 解析求导
   - 二阶导数的计算
   - 矩阵求逆的数值稳定性

**讨论问题:**
- 在小样本情况下,渐近方差的估计有多可靠?
- Bootstrap方法与Delta方法相比,各有什么优劣?

---

### 七、综合讨论:从理论到应用

**跨题目的联系**:

1. **估计量性质的层次**:
   - 有限样本性质(无偏性) - 题目1
   - 大样本性质(一致性、渐近正态性) - 题目2, 7
   - 效率比较(3SLS vs 2SLS) - 题目3

2. **估计方法的选择**:
   - OLS: 简单但要求严格 - 题目1, 6
   - IV/GMM: 处理内生性 - 题目3  
   - MLE: 效率最优但需要分布假设 - 题目4, 5, 7

3. **推断方法的统一框架**:
   - 点估计 → 方差估计 → 假设检验
   - 所有题目都涉及这个完整流程

**实践中的思考**:
- 如何在模型假设、估计效率和计算复杂度之间权衡?
- 在实际数据分析中,如何验证这些理论假设?
- 当理论假设不满足时,有哪些稳健性方法?