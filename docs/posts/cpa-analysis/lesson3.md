FGLS 全称是 **Feasible Generalized Least Squares**（可行广义最小二乘法），是计量经济学中一种在误差项存在**异方差**或**自相关**时，用来改进普通最小二乘法（OLS）估计效率的技术。

---

### 一、背景：为什么需要 FGLS？

OLS（普通最小二乘）在经典线性回归假设中要求：
[
Var(\varepsilon_i) = \sigma^2
]
即误差项必须是 **同方差（homoskedastic）且互不相关（no autocorrelation）**。

但在实际中，这个条件往往被违反：

* 在**截面数据**中，常出现异方差（不同观测值的方差不同）；
* 在**时间序列数据**中，常出现自相关（误差之间有关联）。

当这些问题存在时：

* OLS 估计量依然**无偏且一致**，
* 但它**不再是最有效的**（即不再是最小方差的线性无偏估计）。

这时，我们可以用 **广义最小二乘法（GLS）** 来提高效率。

---

### 二、GLS 的基本思想

假设线性模型：
[
y = X\beta + \varepsilon, \quad Var(\varepsilon) = \Omega
]
其中 (\Omega) 是误差项的协方差矩阵（不是 (\sigma^2 I)）。
如果我们知道 (\Omega)，则 GLS 估计量为：
[
\hat{\beta}_{GLS} = (X' \Omega^{-1} X)^{-1} X' \Omega^{-1} y
]
这个估计量在异方差或自相关情况下仍然是**BLUE**（最优线性无偏估计量）。

---

### 三、FGLS 的“可行性”（Feasible）

问题是：在现实中我们 **不知道 (\Omega)**。
于是我们需要先**估计 (\Omega)**，再代入 GLS。

这就得到了 **FGLS（Feasible GLS）**，步骤如下：

1. **先用 OLS 拟合模型**，得到残差 (\hat{\varepsilon})。
2. **根据残差模式估计 (\Omega)**。

   * 若怀疑异方差，可根据 (\hat{\varepsilon}_i^2) 建模；
   * 若怀疑自相关，可假设 AR(1) 过程并估计参数 (\rho)。
3. **用估计得到的 (\hat{\Omega})** 代入 GLS：
   [
   \hat{\beta}_{FGLS} = (X' \hat{\Omega}^{-1} X)^{-1} X' \hat{\Omega}^{-1} y
   ]

---

### 四、一个直观例子（异方差情况）

假设误差项方差与某个变量 (z_i) 成正比：
[
Var(\varepsilon_i) = \sigma^2 z_i^2
]

则我们可以对模型两边都除以 (z_i)：
[
\frac{y_i}{z_i} = \frac{x_i}{z_i}\beta + \frac{\varepsilon_i}{z_i}
]
这样新的误差项就变成同方差的。
这个过程本质上就是 GLS（或 FGLS）思想的具体应用。

---

### 五、性质与注意事项

| 特点    | 描述                                              |
| ----- | ----------------------------------------------- |
| 无偏性   | FGLS 一般是**一致估计**，但不一定严格无偏。                      |
| 效率    | 在样本量足够大时，比 OLS 更有效（方差更小）。                       |
| 实践中   | 常用于检测和校正异方差（如 White 修正）或自相关（如 Cochrane-Orcutt）。 |
| 小样本问题 | 估计 (\Omega) 可能引入额外误差，小样本下反而不如 OLS 稳定。           |

---

### 六、与 OLS 的比较总结

| 性质    | OLS      | FGLS              |
| ----- | -------- | ----------------- |
| 假设    | 同方差、无自相关 | 允许异方差、自相关         |
| 方差估计  | 简单       | 依赖 (\hat{\Omega}) |
| 有效性   | 低        | 高                 |
| 实际可行性 | 简单直接     | 需要额外估计步骤          |

