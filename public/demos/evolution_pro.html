<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <title>æ³°å¦è®¡åˆ’ - å…¨æ™¯æ¼”åŒ–æ ‘æ²™ç›˜ (ä»£å·: TITAN)</title>
    <script src="https://cdn.jsdelivr.net/npm/mermaid@10.6.1/dist/mermaid.min.js"></script>
    <style>
        :root { --primary: #3b82f6; --bg: #f1f5f9; --panel: #ffffff; --border: #cbd5e1; }
        body { font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Helvetica, Arial, sans-serif; display: flex; height: 100vh; margin: 0; background: var(--bg); color: #334155; overflow: hidden; }
        
        /* å¸ƒå±€å®¹å™¨ */
        #left-col { width: 280px; display: flex; flex-direction: column; border-right: 1px solid var(--border); background: var(--panel); z-index: 2; box-shadow: 2px 0 10px rgba(0,0,0,0.05); }
        #main-col { flex-grow: 1; display: flex; flex-direction: column; overflow: hidden; position: relative; }
        #right-col { width: 400px; border-left: 1px solid var(--border); background: #f8fafc; overflow-y: auto; z-index: 2; box-shadow: -2px 0 10px rgba(0,0,0,0.05); display: flex; flex-direction: column; }

        /* å·¦ä¾§æ—¥å¿— */
        #log-header { padding: 15px; border-bottom: 1px solid var(--border); background: #fce7f3; }
        #log-header h3 { margin: 0; font-size: 16px; color: #be185d; }
        #log-list-container { flex-grow: 1; overflow-y: auto; padding: 10px; scroll-behavior: smooth; }
        .log-item { padding: 10px; margin-bottom: 6px; border-radius: 4px; background: #fff; font-size: 12px; cursor: pointer; border-left: 3px solid #94a3b8; box-shadow: 0 1px 2px rgba(0,0,0,0.05); transition: all 0.2s; }
        .log-item:hover { background: #f1f5f9; }
        .log-item.active { border-left-color: var(--primary); background: #eff6ff; font-weight: 600; transform: translateX(2px); }
        .log-meta { display: flex; justify-content: space-between; color: #64748b; font-size: 11px; margin-bottom: 4px; }

        /* ä¸­é—´ç”»å¸ƒ */
        #toolbar { padding: 10px 20px; background: var(--panel); border-bottom: 1px solid var(--border); display: flex; gap: 10px; align-items: center; }
        button { padding: 8px 16px; background: var(--primary); color: white; border: none; border-radius: 6px; cursor: pointer; font-weight: 500; transition: background 0.2s; font-size: 13px; }
        button:hover { background: #2563eb; }
        button.secondary { background: #64748b; }
        button:disabled { background: #cbd5e1; cursor: not-allowed; }
        #progress-bar { flex-grow: 1; height: 8px; background: #e2e8f0; border-radius: 4px; overflow: hidden; }
        #progress-fill { height: 100%; background: var(--primary); width: 0%; transition: width 0.3s; }
        #viz-container { flex-grow: 1; overflow: auto; padding: 20px; background: #f8fafc; display: flex; justify-content: center; align-items: flex-start; }
        #tree-graph { background: white; padding: 30px; border-radius: 12px; box-shadow: 0 4px 20px rgba(0,0,0,0.08); }

        /* å³ä¾§è¯¦æƒ… */
        #inspector-header { padding: 20px; border-bottom: 1px solid var(--border); background: #fff; }
        #inspect-title { margin: 0; font-size: 20px; color: #1e293b; }
        #inspect-id-tag { display: inline-block; background: #e2e8f0; padding: 4px 8px; border-radius: 4px; font-size: 12px; color: #475569; margin-top: 8px; font-family: monospace; }
        #inspector-body { padding: 20px; flex-grow: 1; overflow-y: auto; }
        .ert-section { margin-bottom: 25px; }
        .ert-label { font-weight: 700; font-size: 13px; color: #64748b; text-transform: uppercase; letter-spacing: 0.05em; margin-bottom: 8px; display: flex; align-items: center; }
        .ert-content { font-size: 14px; background: #fff; padding: 15px; border-radius: 8px; border: 1px solid var(--border); line-height: 1.6; color: #334155; box-shadow: 0 1px 3px rgba(0,0,0,0.05); }
        .empty-state { text-align: center; padding: 50px 20px; color: #94a3b8; }
        
        /* Mermaid æ ·å¼è¦†ç›– */
        .node rect, .node circle, .node polygon { stroke-width: 2px; }
        .node.paused rect { fill: #fef2f2 !important; stroke: #ef4444 !important; stroke-dasharray: 5 5; }
        .node.completed rect { fill: #f0fdf4 !important; stroke: #22c55e !important; }
        .node.blocked rect { fill: #fff7ed !important; stroke: #f97316 !important; }
    </style>
</head>
<body>

<div id="left-col">
    <div id="log-header">
        <h3>ğŸ“… é¡¹ç›®æ¼”åŒ–æ—¥å¿—æµ (Q1-Q2)</h3>
    </div>
    <div id="log-list-container">
        <div id="log-list"></div>
    </div>
</div>

<div id="main-col">
    <div id="toolbar">
        <button id="next-btn">â–¶ æ­¥è¿›æ¨æ¼” (Step)</button>
        <button id="fast-fwd-btn" class="secondary">â© ç¬é—´åŠ è½½å…¨é‡ (Shock)</button>
        <div id="progress-bar"><div id="progress-fill"></div></div>
        <span id="status-text" style="font-size: 12px; color: #64748b;">å‡†å¤‡å°±ç»ª</span>
    </div>
    <div id="viz-container">
        <div class="mermaid" id="tree-graph">
            graph TD;
            START((ç­‰å¾…æ•°æ®æ³¨å…¥...)):::startClass
            classDef startClass fill:#f1f5f9,stroke:#cbd5e1,color:#94a3b8;
        </div>
    </div>
</div>

<div id="right-col">
    <div id="inspector-header">
        <h2 id="inspect-title">å†³ç­–é€è§†é•œ</h2>
        <span id="inspect-id-tag">ç‚¹å‡»å·¦ä¾§æ—¥å¿—æˆ–å›¾ä¸ŠèŠ‚ç‚¹æŸ¥çœ‹è¯¦æƒ…</span>
    </div>
    <div id="inspector-body">
        <div id="inspector-content" style="display:none;">
            <div class="ert-section">
                <span class="ert-label">ğŸ¯ é¢„æœŸç›®æ ‡ (Expectation)</span>
                <div class="ert-content" id="inspect-exp"></div>
            </div>
            <div class="ert-section">
                <span class="ert-label">ğŸ“Š æ‰§è¡Œç»“æœ (Result)</span>
                <div class="ert-content" id="inspect-res"></div>
            </div>
            <div class="ert-section">
                <span class="ert-label">ğŸ’¡ æ ¸å¿ƒæ€è€ƒ (Thought / Context)</span>
                <div class="ert-content" id="inspect-tht" style="background: #f8fafc; border-left: 4px solid var(--primary);"></div>
            </div>
        </div>
        <div class="empty-state" id="inspector-empty">
            <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" style="width: 48px; height: 48px; margin-bottom: 10px; opacity: 0.5;">
              <path stroke-linecap="round" stroke-linejoin="round" d="M2.036 12.322a1.012 1.012 0 0 1 0-.639C3.423 7.51 7.36 4.5 12 4.5c4.638 0 8.573 3.007 9.963 7.178.07.207.07.431 0 .639C20.577 16.49 16.64 19.5 12 19.5c-4.638 0-8.573-3.007-9.963-7.178Z" />
              <path stroke-linecap="round" stroke-linejoin="round" d="M15 12a3 3 0 1 1-6 0 3 3 0 0 1 6 0Z" />
            </svg>
            <p>è¯·åœ¨æ¼”åŒ–æ ‘ä¸Šé€‰æ‹©ä¸€ä¸ªèŠ‚ç‚¹<br>ä»¥æŸ¥çœ‹å…¶èƒŒåçš„å†³ç­–é€»è¾‘ã€‚</p>
        </div>
    </div>
</div>

<script>
    mermaid.initialize({ 
        startOnLoad: false, 
        theme: 'base',
        themeVariables: { fontFamily: 'sans-serif', fontSize: '14px' },
        flowchart: { curve: 'basis', rankSpacing: 80, nodeSpacing: 40 },
        securityLevel: 'loose'
    });

    // ==========================================
    // æ ¸å¿ƒæ•°æ®é›†ï¼šæ³°å¦è®¡åˆ’åŠå¹´æ¼”åŒ–å² (50+èŠ‚ç‚¹)
    // ==========================================
    const titanData = [
        // M1: æˆ˜ç•¥å¯åŠ¨æœŸ
        { id: "ROOT", title: "ğŸš€ æ³°å¦è®¡åˆ’ (Project Titan)", parent: null, exp: "æ‰“é€ ä¸‹ä¸€ä»£æ™ºèƒ½ç»ˆç«¯ç”Ÿæ€", res: "é¡¹ç›®å¯åŠ¨", tht: "å…¬å¸å¹´åº¦æœ€é«˜ä¼˜å…ˆçº§æˆ˜ç•¥" },
        { id: "OS-01", title: "è‡ªç ”å¾®å†…æ ¸ OS", parent: "ROOT", exp: "æŒæ¡åº•å±‚æ ¸å¿ƒæŠ€æœ¯ï¼Œæå‡å®æ—¶æ€§", res: "å†…æ ¸å›¢é˜Ÿç»„å»ºå®Œæˆ", tht: "å¿…é¡»æ‘†è„±å¯¹å¤–éƒ¨å•†ä¸š RTOS çš„ä¾èµ–" },
        { id: "AD-01", title: "é«˜é˜¶è‡ªåŠ¨é©¾é©¶ç³»ç»Ÿ", parent: "ROOT", exp: "å®ç°åŸåŒº NOP åŠŸèƒ½", res: "æ„ŸçŸ¥/è§„æ§/ç¡¬ä»¶å›¢é˜Ÿåˆ°ä½", tht: "æ ¸å¿ƒå–ç‚¹ï¼Œä¸å®¹æœ‰å¤±" },
        { id: "AI-01", title: "å¤šæ¨¡æ€åº§èˆ±å¤§è„‘", parent: "ROOT", exp: "è¯­éŸ³+è§†è§‰æ·±åº¦èåˆäº¤äº’", res: "åŸºç¡€æ¡†æ¶æ­å»ºä¸­", tht: "å¯¹æ ‡è¡Œä¸šå¤´éƒ¨ç«å“" },
        
        // M2: æ—©æœŸæ‹†è§£ä¸å¹¶è¡Œæ¨è¿›
        { id: "OS-02", title: "å†…å­˜ç®¡ç†æ¨¡å—", parent: "OS-01", exp: "å®ç°ç¡®å®šæ€§å†…å­˜åˆ†é…", res: "è®¾è®¡è¯„å®¡é€šè¿‡", tht: "é«˜å®‰å…¨æ€§çš„åŸºçŸ³" },
        { id: "OS-03", title: "è°ƒåº¦å™¨å¼€å‘", parent: "OS-01", exp: "æ”¯æŒæ··åˆå…³é”®æ€§è°ƒåº¦", res: "åŸå‹å¼€å‘ä¸­", tht: "è¦åŒæ—¶è·‘é€šä¿¡æ¯å¨±ä¹å’Œè½¦æ§ä»»åŠ¡" },
        { id: "AD-02", title: "æ„ŸçŸ¥èåˆç®—æ³•", parent: "AD-01", exp: "æ¿€å…‰é›·è¾¾+è§†è§‰å‰èåˆ", res: "æ•°æ®é‡‡é›†è½¦ä¸Šè·¯", tht: "ç›®å‰æœ€ä¸»æµçš„æŠ€æœ¯è·¯çº¿" },
        { id: "AD-03", title: "å¤§ç®—åŠ›è®¡ç®—å¹³å°", parent: "AD-01", exp: "é€‰å‹ Orin-X èŠ¯ç‰‡", res: "å¼€å‘æ¿å·²å›ç‰‡", tht: "ç®—åŠ›æ˜¯ç®—æ³•çš„å¤©èŠ±æ¿" },
        { id: "AI-02", title: "ç¦»çº¿è¯­éŸ³è¯†åˆ«", parent: "AI-01", exp: "æ— ç½‘çŠ¶æ€ä¸‹å¯ç”¨", res: "æ¨¡å‹å‰ªæè‡³ 200MB", tht: "åœ°åº“ç­‰åœºæ™¯æ˜¯åˆšéœ€", status: "COMPLETED" },

        // M3: ç¬¬ä¸€æ¬¡å±æœºä¸åˆ†æ­§ (Reality Check)
        { id: "OS-CR-01", title: "è°ƒåº¦å™¨æ­»é”å±æœº", parent: "OS-03", exp: "è§£å†³é«˜è´Ÿè½½ä¸‹çš„æ­»é”é—®é¢˜", res: "å¤ç°å›°éš¾ï¼Œè¿›åº¦å—é˜»", tht: "ä¸¥é‡é˜»å¡äº†ä¸Šå±‚åº”ç”¨å¼€å‘", status: "BLOCKED" },
        { id: "AD-BK-01", title: "ä¾›åº”å•†Aé›·è¾¾æ–­ä¾›", parent: "AD-02", exp: "ç­‰å¾…ä¾›åº”å•†Aäº¤è´§", res: "ä¾›åº”å•†ç ´äº§æ¸…ç®—", tht: "çªå‘é»‘å¤©é¹…äº‹ä»¶ï¼Œå¿…é¡»é©¬ä¸Šå¯»æ‰¾æ›¿ä»£æ–¹æ¡ˆ", status: "PAUSED" },
        { id: "AI-DP-01", title: "åº§èˆ±è§†è§‰ä¾èµ–é¡¹", parent: "AI-01", exp: "ç­‰å¾… OS æä¾›æ‘„åƒå¤´é©±åŠ¨", res: "OSå›¢é˜Ÿå› æ­»é”é—®é¢˜å»¶æœŸäº¤ä»˜", tht: "è·¨éƒ¨é—¨ä¾èµ–å¯¼è‡´æˆ‘ä»¬åœå·¥å¾…æ–™", status: "BLOCKED" },

        // M4: è‰°éš¾çš„è½¬å‘ä¸å¦¥å (The Pivot)
        { id: "AD-PV-01", title: "è½¬å‘çº¯è§†è§‰è·¯çº¿", parent: "AD-BK-01", exp: "æ”¾å¼ƒé›·è¾¾ï¼Œæ­»ç£•è§†è§‰", res: "ç®—æ³•å›¢é˜Ÿç«‹ä¸‹å†›ä»¤çŠ¶", tht: "è¢«è¿«çš„è±ªèµŒï¼Œç‰¹æ–¯æ‹‰è·¯çº¿éªŒè¯å¯è¡Œï¼Œä½†éš¾åº¦æå¤§" },
        { id: "OS-FIX-01", title: "å¼•å…¥å½¢å¼åŒ–éªŒè¯", parent: "OS-CR-01", exp: "ç”¨æ•°å­¦æ–¹æ³•è¯æ˜è°ƒåº¦æ— æ­»é”", res: "éªŒè¯é€šè¿‡ï¼Œæ‰¾åˆ°éšè— Bug", tht: "è™½ç„¶æ…¢ï¼Œä½†æ˜¯å”¯ä¸€å¯é çš„æ–¹æ³•ï¼Œä»£ä»·æ˜¯è¿›åº¦å»¶åä¸€ä¸ªæœˆ" },
        { id: "MKT-01", title: "Q2 å‘å¸ƒä¼šç­¹å¤‡", parent: "ROOT", exp: "å¯¹å¤–å±•ç¤ºé˜¶æ®µæ€§æˆæœ", res: "æ–¹æ¡ˆç­–åˆ’ä¸­", tht: "éœ€è¦ææŒ¯å¸‚åœºä¿¡å¿ƒ" },
        { id: "MKT-PV-01", title: "è°ƒæ•´å®£ä¼ å£å¾„", parent: "MKT-01", exp: "å¼±åŒ–æ¿€å…‰é›·è¾¾ï¼Œå¼ºè°ƒè§†è§‰ AI", res: "é€šç¨¿é‡å†™", tht: "å›  AD-PV-01 çš„æŠ€æœ¯è·¯çº¿å˜æ›´å¯¼è‡´çš„å„ç§ç‰©æ–™è°ƒæ•´" },

        // M5: æ·±æ°´åŒºä¸æœ‰æœºç”Ÿé•¿ (The Slog & Growth)
        { id: "AI-OG-01", title: "æ–¹è¨€æƒ…æ„Ÿå¼•æ“", parent: "AI-02", exp: "åŸºäºå·²å®Œæˆçš„ç¦»çº¿è¯­éŸ³ï¼Œå¢åŠ æƒ…æ„Ÿ", res: "é¢„ç ”é€šè¿‡", tht: "ä»å·²å®Œæˆä»»åŠ¡ä¸­é•¿å‡ºçš„æ–°éœ€æ±‚ï¼Œå¢åŠ ç”¨æˆ·ç²˜æ€§" },
        { id: "AD-OPT-01", title: "BEVTransformer ä¼˜åŒ–", parent: "AD-PV-01", exp: "ä¼˜åŒ–çº¯è§†è§‰æ¨¡å‹çš„æ—¶å»¶", res: "ç›®å‰æ—¶å»¶ 150msï¼Œç›®æ ‡ <80ms", tht: "çº¯è§†è§‰è·¯çº¿çš„å…³é”®å¡ç‚¹" },
        { id: "AD-HW-01", title: "NPUä¸“ç”¨ç®—å­å¼€å‘", parent: "AD-OPT-01", exp: "æ‰‹å†™æ±‡ç¼–å‹æ¦¨èŠ¯ç‰‡æ€§èƒ½", res: "æ€§èƒ½æå‡ 40%", tht: "ä¸ºäº†æ´»ä¸‹å»ï¼Œä»€ä¹ˆè„æ´»ç´¯æ´»éƒ½è¦å¹²" },
        { id: "OS-MW-01", title: "é€šä¿¡ä¸­é—´ä»¶", parent: "OS-01", exp: "å®ç°è·¨æ ¸é«˜æ•ˆé€šä¿¡", res: "åŸºäº DDS æ”¹è‰¯", tht: "è¿æ¥ OS å†…æ ¸ä¸ä¸Šå±‚åº”ç”¨çš„å…³é”®æ¡¥æ¢" },
        
        // M6: å†²åˆºä¸æ–°çš„ä¸ç¡®å®šæ€§ (The Final Push)
        { id: "INT-01", title: "ç¬¬ä¸€æ¬¡å…¨ç³»ç»Ÿé›†æˆ", parent: "ROOT", exp: "OS+AD+AI è·‘é€šé—­ç¯", res: "å¤§é‡å…¼å®¹æ€§é—®é¢˜çˆ†å‘", tht: "é»æ˜å‰çš„é»‘æš—" },
        { id: "INT-BUG-01", title: "éŸ³è§†é¢‘ä¸åŒæ­¥ä¸“é¡¹", parent: "INT-01", exp: "è§£å†³å˜´å‹å’Œå£°éŸ³å¯¹ä¸ä¸Šçš„é—®é¢˜", res: "å®šä½åˆ°ä¸­é—´ä»¶æ—¶é—´æˆ³é—®é¢˜", tht: "è·¨éƒ¨é—¨è”åˆ Debug æ”»åšé˜Ÿ" },
        { id: "AD-NEW-01", title: "æ¢ç´¢ç«¯åˆ°ç«¯å¤§æ¨¡å‹", parent: "AD-PV-01", exp: "ä¸‹ä¸€ä»£æŠ€æœ¯é¢„ç ”", res: "ç«‹é¡¹åˆ†æ", tht: "è™½ç„¶å½“å‰å¾ˆå¿™ï¼Œä½†å¿…é¡»çœ‹æœªæ¥ï¼Œé˜²æ­¢è¢«é¢ è¦†" },
        { id: "FIN-01", title: "Bè½®èèµ„å¯¹æ¥", parent: "ROOT", exp: "å±•ç¤ºDemoï¼Œé”å®šèµ„é‡‘", res: "æŠ•èµ„äººå¯¹çº¯è§†è§‰æ–¹æ¡ˆå­˜ç–‘", tht: "æŠ€æœ¯å†³ç­–ç›´æ¥å½±å“å…¬å¸ç”Ÿæ­»å­˜äº¡" }
        // ... å¯ä»¥ç»§ç»­æ·»åŠ æ›´å¤šèŠ‚ç‚¹ä»¥å¢åŠ å¤æ‚æ€§
    ];

    let currentStep = 0;
    let activeData = [];
    const treeGraph = document.getElementById('tree-graph');
    const logList = document.getElementById('log-list');
    const progressBar = document.getElementById('progress-fill');
    const statusText = document.getElementById('status-text');
    const nextBtn = document.getElementById('next-btn');
    const fastFwdBtn = document.getElementById('fast-fwd-btn');

    // åˆå§‹åŒ–æ—¥å¿—åˆ—è¡¨
    titanData.forEach((log, index) => {
        const div = document.createElement('div');
        div.className = 'log-item';
        div.id = `log-${log.id}`;
        div.innerHTML = `
            <div class="log-meta"><span>Step ${index + 1}</span><span>ID: ${log.id}</span></div>
            <div style="font-weight:500">${log.title}</div>
        `;
        div.onclick = () => window.callNodeClick(log.id);
        logList.appendChild(div);
    });

    // æ ¸å¿ƒæ¸²æŸ“å‡½æ•°
    async function renderGraph(data) {
        let code = "graph TD\n";
        // å¢åŠ ä¸€äº›æ ·å¼å®šä¹‰
        code += "classDef default fill:#fff,stroke:#334155,stroke-width:1px;\n";
        code += "classDef root fill:#dbeafe,stroke:#2563eb,stroke-width:2px,font-weight:bold;\n";
        code += "classDef paused fill:#fef2f2,stroke:#ef4444,stroke-width:2px,stroke-dasharray: 5 5;\n";
        code += "classDef completed fill:#dcfce7,stroke:#22c55e,stroke-width:2px;\n";
        code += "classDef blocked fill:#fff7ed,stroke:#f97316,stroke-width:2px;\n";

        data.forEach(node => {
            // æ„å»ºèŠ‚ç‚¹æ ·å¼
            let styleClass = "";
            if (node.id === "ROOT") styleClass = ":::root";
            else if (node.status === "PAUSED") styleClass = ":::paused";
            else if (node.status === "COMPLETED") styleClass = ":::completed";
            else if (node.status === "BLOCKED") styleClass = ":::blocked";

            const nodeLabel = `["${node.title}"]${styleClass}`;
            
            if (node.parent) {
                code += `${node.parent} --> ${node.id}${nodeLabel}\n`;
            } else {
                code += `${node.id}${nodeLabel}\n`;
            }
            // æ·»åŠ äº¤äº’äº‹ä»¶
            code += `click ${node.id} callNodeClick\n`;
        });

        try {
            treeGraph.innerHTML = code;
            treeGraph.removeAttribute('data-processed');
            await mermaid.run({ nodes: [treeGraph] });
        } catch (e) {
            console.error("Mermaid rendering error:", e);
            statusText.innerText = "æ¸²æŸ“é”™è¯¯ (å¯èƒ½æ˜¯èŠ‚ç‚¹è¿‡å¤š)";
        }
    }

    // æ›´æ–°è¿›åº¦æ¡å’ŒçŠ¶æ€
    function updateProgress() {
        const percent = Math.round((currentStep / titanData.length) * 100);
        progressBar.style.width = `${percent}%`;
        statusText.innerText = `æ¼”åŒ–è¿›åº¦: ${currentStep}/${titanData.length} èŠ‚ç‚¹`;
        
        document.querySelectorAll('.log-item').forEach(el => el.classList.remove('active'));
        for(let i=0; i<currentStep; i++) {
             document.getElementById(`log-${titanData[i].id}`).classList.add('active');
        }
        // æ»šåŠ¨æ—¥å¿—åˆ°æœ€æ–°
        if(currentStep > 0) {
            document.getElementById(`log-${titanData[currentStep-1].id}`).scrollIntoView({ behavior: "smooth", block: "nearest" });
        }

        if (currentStep >= titanData.length) {
            nextBtn.disabled = true;
            fastFwdBtn.disabled = true;
            statusText.innerText = "æ¼”åŒ–å®Œæˆã€‚è¯·ç‚¹å‡»èŠ‚ç‚¹æŸ¥çœ‹å¤æ‚çš„å†³ç­–é“¾è·¯ã€‚";
            statusText.style.color = "var(--primary)";
            statusText.style.fontWeight = "bold";
        }
    }

    // æ­¥è¿›åŠ¨ä½œ
    async function step() {
        if (currentStep >= titanData.length) return;
        activeData.push(titanData[currentStep]);
        currentStep++;
        updateProgress();
        await renderGraph(activeData);
    }

    // ç¬é—´åŠ è½½åŠ¨ä½œ
    async function fastForward() {
        activeData = [...titanData];
        currentStep = titanData.length;
        updateProgress();
        await renderGraph(activeData);
    }

    // èŠ‚ç‚¹ç‚¹å‡»å›è°ƒ (æš´éœ²ç»™å…¨å±€)
    window.callNodeClick = function(id) {
        const node = titanData.find(d => d.id === id);
        if (!node) return;

        document.getElementById('inspector-empty').style.display = 'none';
        document.getElementById('inspector-content').style.display = 'block';
        
        document.getElementById('inspect-title').innerText = node.title;
        let statusTag = "";
        if(node.status) statusTag = ` | çŠ¶æ€: ${node.status}`;
        document.getElementById('inspect-id-tag').innerText = `ID: ${node.id}${statusTag}`;
        
        document.getElementById('inspect-exp').innerText = node.exp || "-";
        document.getElementById('inspect-res').innerText = node.res || "è¿›è¡Œä¸­...";
        document.getElementById('inspect-tht').innerText = node.tht || "-";

        // é«˜äº®å¯¹åº”çš„æ—¥å¿—
        document.querySelectorAll('.log-item').forEach(el => el.classList.remove('active'));
        document.getElementById(`log-${id}`).classList.add('active');
        document.getElementById(`log-${id}`).scrollIntoView({ behavior: "smooth", block: "nearest" });
    };

    // äº‹ä»¶ç»‘å®š
    nextBtn.addEventListener('click', step);
    fastFwdBtn.addEventListener('click', fastForward);

    // åˆå§‹æ¸²æŸ“
    renderGraph([]);
</script>
</body>
</html>